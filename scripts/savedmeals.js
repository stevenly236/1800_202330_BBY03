function doAll() {
    firebase.auth().onAuthStateChanged(user => {
        if (user) {
            getBookmarks(user)
        } else {
            console.log("No user is signed in");
        }
    });
}
doAll();

function getBookmarks(user) {
    db.collection("users").doc(user.uid).get()
        .then(userDoc => {

					  // Get the Array of bookmarks
            var bookmarks = userDoc.data().bookmarks;
            console.log(bookmarks);
												
						// Get pointer the new card template
            let mealTemplate = document.getElementById("mealTemplate");

						// Iterate through the ARRAY of bookmarked hikes (document ID's)
            bookmarks.forEach(thisMeal => {
                console.log(thisMeal);
                db.collection("meals")
                    .doc(thisMeal)
                    .get()
                    .then( doc => {
                        var docID = doc.id;  //this is the autogenerated ID of the document
                        var image = doc.data().image;
                        var mealName = doc.data().name;
                        var desc = doc.data().description;
                        var update = doc.data().last_updated.toDate().toLocaleDateString();
                        //clone the new card
                        let newmeal = mealTemplate.content.cloneNode(true);

                        //update title and some pertinant information
                        let imgEvent = newmeal.querySelector(".meal-img");
                        imgEvent.src = image;
                        newmeal.querySelector('a').href = "meal.html?docID=" + docID;
                        newmeal.querySelector(".card-title").innerHTML = mealName;
                        newmeal.querySelector(".card-text").innerHTML = desc;
                        newmeal.querySelector(".update").innerHTML = update;

                        document.getElementById("meals-go-here").appendChild(newmeal);
                })
            });
        })
}		